<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Цикл Цвета - Редактирование</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        h1 {
            text-align: center;
            margin-top: 10px;
        }

        label, input, button {
            display: block;
            margin-bottom: 10px;
        }

        input, button {
            width: 100%;
            padding: 8px;
            box-sizing: border-box;
        }

        #colorDisplay {
            width: 100%;
            height: 200px;
            margin-top: 10px;
            border: 2px solid black;
            cursor: pointer;
        }

        .color-field {
            margin-bottom: 10px;
            cursor: move;
        }
    </style>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Sortable/1.14.0/Sortable.min.js"></script>
</head>
<body>
    <h1>Цикл Цвета - Редактирование</h1>

    <label for="repetitions">Количество повторений (J): </label>
    <input type="number" id="repetitions" min="1" value="1">

    <div id="colorFields">
        <div class="color-field">
            <label for="color">Цвет (X): </label>
            <input type="color" class="colorInput" value="#ff0000">
            <label for="duration">Длительность (N): </label>
            <input type="number" class="durationInput" min="1" value="1">
        </div>
    </div>

    <button onclick="startColorLoop()">Начать</button>
    <button onclick="addColorField()">Добавить поле цвета</button>
    <button onclick="removeColorField()">Удалить последнее поле цвета</button>

    <div id="colorDisplay"></div>

    <script>
        function startColorLoop() {
            var repetitions = document.getElementById('repetitions').value;
            var colorDisplay = document.getElementById('colorDisplay');
            var colorFields = document.querySelectorAll('.colorInput');
            var durationFields = document.querySelectorAll('.durationInput');

            for (var i = 0; i < repetitions; i++) {
                colorFields.forEach(function(colorField, index) {
                    var color = colorField.value;
                    var duration = durationFields[index].value;

                    setTimeout(function() {
                        colorDisplay.style.backgroundColor = color;
                        redirectToDisplayPage();
                    }, i * duration * 1000);
                });
            }
        }

        function addColorField() {
            var colorFields = document.getElementById('colorFields');
            var newColorField = document.createElement('div');
            newColorField.className = 'color-field';
            newColorField.innerHTML = `
                <label for="color">Цвет (X): </label>
                <input type="color" class="colorInput" value="#ff0000">
                <label for="duration">Длительность (N): </label>
                <input type="number" class="durationInput" min="1" value="1">
            `;
            colorFields.appendChild(newColorField);
            initSortable();
        }

        function removeColorField() {
            var colorFields = document.getElementById('colorFields');
            var children = colorFields.children;
            if (children.length > 1) {
                colorFields.removeChild(children[children.length - 1]);
            }
        }

        function initSortable() {
            new Sortable(document.getElementById('colorFields'), {
                animation: 150,
                handle: '.color-field',
            });
        }

        function redirectToDisplayPage() {
            window.location.href = 'display.html';
        }

        // Initialize sortable on page load
        document.addEventListener('DOMContentLoaded', initSortable);
    </script>
</body>
</html>
